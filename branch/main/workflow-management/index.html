

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Recording computational steps &mdash; Starting computational Research Projects at Aalto  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=949a1ff5" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_lesson.css?v=e9df6548" />
      <link rel="stylesheet" type="text/css" href="../_static/term_role_formatting.css?v=4194e21c" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=187304be"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=582ca9e2"></script>
      <script src="../_static/minipres.js?v=a0d29692"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script data-domain="aaltorse.github.io" defer="defer" src="https://plausible.cs.aalto.fi/js/script.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Recording dependencies" href="../dependencies/" />
    <link rel="prev" title="Organizing your projects" href="../organizing-projects/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Starting computational Research Projects at Aalto
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Core episodes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../motivation/">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../organizing-projects/">Organizing your projects</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Recording computational steps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#several-steps-from-input-data-to-result">Several steps from input data to result</a></li>
<li class="toctree-l2"><a class="reference internal" href="#workflow-managers">Workflow managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-tools">Additional Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies/">Recording dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/">Recording environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../where-to-go/">Where to go from here</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://youtu.be/xbTTDLA3txI">Shell crash course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/">List of exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/">Instructor guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/core/">All lessons</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/">CodeRefinery</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/reusing/">Reusing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Starting computational Research Projects at Aalto</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Recording computational steps</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/AaltoRSE/starting-computational-research-projects/blob/main/content/workflow-management.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="recording-computational-steps">
<h1>Recording computational steps<a class="headerlink" href="#recording-computational-steps" title="Link to this heading"></a></h1>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Know what is the minimal amount of information necessary to reproduce your results</p></li>
<li><p>How can you make it easier for others (or your later self) to reproduce your work</p></li>
<li><p>Understand why and when a workflow management tool can be useful</p></li>
</ul>
</div>
<div class="admonition-questions questions admonition" id="questions-0">
<p class="admonition-title">Questions</p>
<ul class="simple">
<li><p>You have some steps that need to be run to do your work.  How do you
actually run them?  Does it rely on your own memory and work, or is it
reproducible? <strong>How do you communicate the steps</strong> for future you and others?</p></li>
<li><p>How can we create a reproducible workflow?</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>5 min teaching</p></li>
<li><p>5 min exercise/demo</p></li>
</ul>
</div>
<section id="several-steps-from-input-data-to-result">
<h2>Several steps from input data to result<a class="headerlink" href="#several-steps-from-input-data-to-result" title="Link to this heading"></a></h2>
<p><em>The following material is partly derived from a <a class="reference external" href="https://hpc-carpentry.github.io/hpc-python/">HPC Carpentry lesson</a>.</em></p>
<p>In this episode, we will use an <a class="reference external" href="https://github.com/coderefinery/word-count">example
project</a> which finds frequent
words in books and plots the result from those statistics. In this example we
wish to:</p>
<ol class="arabic simple">
<li><p>Analyze word frequencies using <a class="reference external" href="https://github.com/coderefinery/word-count/blob/main/code/count.py">code/count.py</a>
for 4 books
(they are all in the <a class="reference external" href="https://github.com/coderefinery/word-count/tree/main/data">data</a> directory).</p></li>
<li><p>Plot a histogram using <a class="reference external" href="https://github.com/coderefinery/word-count/blob/main/plot/plot.py">plot/plot.py</a>.</p></li>
</ol>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/arrows.png"><img alt="From book to word counts to plot" src="../_images/arrows.png" style="width: 100%;" />
</a>
</figure>
<p>Example (for one book only):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>code/count.py<span class="w"> </span>data/isles.txt<span class="w"> </span>&gt;<span class="w"> </span>statistics/isles.data
<span class="gp">$ </span>python<span class="w"> </span>code/plot.py<span class="w"> </span>--data-file<span class="w"> </span>statistics/isles.data<span class="w"> </span>--plot-file<span class="w"> </span>plot/isles.png
</pre></div>
</div>
<p>Another way to analyze the data would be via a graphical user interface (GUI), where you can for example drag and drop files and click buttons to do the different processing steps.</p>
<p>We can also express the workflow for all books with a script. The repository includes such script called <code class="docutils literal notranslate"><span class="pre">run_all.sh</span></code>.</p>
<p>We can run it with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>bash<span class="w"> </span>run_all.sh
</pre></div>
</div>
<p>These approaches are fine, when only a few steps are needed, or only a few repetitons are required, but become infeasible when large amounts of data need to be processed.
E.g. you don’t want to do either approach with 500 different books. Clicking 500 times, or having 500 copies of lines with small modifications is bound to introduce typos or other errors.
How could we deal with this?</p>
<ul class="simple">
<li><p>Loops with automated argument lists or other approaches to specify the inputs</p></li>
<li><p>Workflow managers</p></li>
</ul>
<p>The simpler way, to just get reproducible results is to have tools generate the inputs automatically e.g. using “one folder/file per input” approaches.
This will lead to reproducible results, but requires that for every change everything has to be re-run. E.g. when adding another 10 datapoints, if your script just checks
what is there, it will re-run the analysis for all 1000 other elements as well, and if you start adding more arguments to your script, you risk the forgetting elements or
having typos again.
The advantage of this approach, however, is that you can easily build a executable manuscript file from such a script (like jupyter notebooks, or matlab live code).</p>
</section>
<section id="workflow-managers">
<h2>Workflow managers<a class="headerlink" href="#workflow-managers" title="Link to this heading"></a></h2>
<p>Workflow managers in contrast create flows that, in general, keep track on what needs to be executed. E.g. <a class="reference external" href="https://snakemake.readthedocs.io/">snakemake</a>
will keep track of what has been processed and only re-run those parts of it’s flow that need updates.
If properly defined (e.g. source files being inputs of steps), it will re-run all analysis starting from a modified step, which makes
results more dependable, since you can’t forget to “run that one new pre-processing step” for some old input data.
An example of how it can be used on triton (which is also generally applicable) can be found <a class="reference external" href="https://github.com/AaltoRSE/snakemake-triton-example">here</a></p>
</section>
<hr class="docutils" />
<section id="additional-tools">
<h2>Additional Tools<a class="headerlink" href="#additional-tools" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.gnu.org/software/make/">Make</a></p></li>
<li><p><a class="reference external" href="https://www.nextflow.io/">Nextflow</a></p></li>
<li><p><a class="reference external" href="https://taskfile.dev/">Task</a></p></li>
<li><p><a class="reference external" href="https://www.commonwl.org/">Common Workflow Language</a></p></li>
<li><p>Many <a class="reference external" href="https://github.com/common-workflow-language/common-workflow-language/wiki/Existing-Workflow-systems">specialized frameworks</a> exist.</p></li>
<li><p><a class="reference external" href="https://raps-with-r.dev/">Book on building reproducible analytical pipelines with R</a></p></li>
<li><p><a class="reference external" href="https://books.ropensci.org/targets/">{targets} R package - make-like pipeline tool for R</a></p></li>
</ul>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Computational steps can be recorded in many ways.</p></li>
<li><p>Workflow tools can help if there are many steps to be executed and/or many datasets to be processed.</p></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../organizing-projects/" class="btn btn-neutral float-left" title="Organizing your projects" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../dependencies/" class="btn btn-neutral float-right" title="Recording dependencies" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright CodeRefinery contributors &amp; AaltoRSE.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>