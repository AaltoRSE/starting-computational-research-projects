

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Recording environments &mdash; Starting computational Research Projects at Aalto  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=949a1ff5" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_lesson.css?v=e9df6548" />
      <link rel="stylesheet" type="text/css" href="../_static/term_role_formatting.css?v=4194e21c" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=187304be"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=582ca9e2"></script>
      <script src="../_static/minipres.js?v=a0d29692"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script data-domain="aaltorse.github.io" defer="defer" src="https://plausible.cs.aalto.fi/js/script.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Where to go from here" href="../where-to-go/" />
    <link rel="prev" title="Recording dependencies" href="../dependencies/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Starting computational Research Projects at Aalto
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Core episodes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../motivation/">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../organizing-projects/">Organizing your projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow-management/">Recording computational steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies/">Recording dependencies</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Recording environments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-a-container">What is a container?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#from-definition-files-to-container-images-to-containers">From definition files to container images to containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#you-may-have-use-for-containers-in-different-ways">You may have use for containers in different ways</a></li>
<li class="toctree-l2"><a class="reference internal" href="#popular-container-implementations">Popular container implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pros-and-cons-of-containers">Pros and cons of containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#resources-for-further-learning">Resources for further learning</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../where-to-go/">Where to go from here</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://youtu.be/xbTTDLA3txI">Shell crash course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/">List of exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/">Instructor guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/core/">All lessons</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/">CodeRefinery</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/reusing/">Reusing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Starting computational Research Projects at Aalto</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Recording environments</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/AaltoRSE/starting-computational-research-projects/blob/main/content/environments.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="recording-environments">
<h1>Recording environments<a class="headerlink" href="#recording-environments" title="Link to this heading"></a></h1>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Understand what containers are and what they are useful for</p></li>
<li><p>Discuss container definitions files in the context of reusability and
reproducibility</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>5 min teaching/discussion</p></li>
<li><p>5 min demo</p></li>
</ul>
</div>
<section id="what-is-a-container">
<h2>What is a container?<a class="headerlink" href="#what-is-a-container" title="Link to this heading"></a></h2>
<p>Imagine if you didn’t have to install things yourself, but instead you could
get a computer with the exact software for a task pre-installed. Containers
effectively do that, with various advantages and disadvantages. They are
<strong>like an entire operating system with software installed, all in one file</strong>.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../_images/docker_meme.jpg"><img alt="He said, then we will ship your machine. And that's how Docker was born." src="../_images/docker_meme.jpg" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">From <a class="reference external" href="https://www.reddit.com/r/ProgrammerHumor/comments/cw58z7/it_works_on_my_machine/">reddit</a>.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="from-definition-files-to-container-images-to-containers">
<h2>From definition files to container images to containers<a class="headerlink" href="#from-definition-files-to-container-images-to-containers" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Containers can be built to bundle <em>all the necessary ingredients</em> (data, code, environment, operating system).</p></li>
<li><p>A container image is like a piece of paper with all the operating system on it. When you run it,
a transparent sheet is placed on top to form a container. The container runs and writes only on
that transparent sheet (and what other mounts have been layered on top). When you are done,
the transparent sheet is thrown away. This can be repeated as often as you want, and base is always the same.</p></li>
<li><p>Definition files (e.g., Dockerfile or Singularity definition file) are text
files that contain a series of instructions to build container images.</p></li>
</ul>
</section>
<section id="you-may-have-use-for-containers-in-different-ways">
<h2>You may have use for containers in different ways<a class="headerlink" href="#you-may-have-use-for-containers-in-different-ways" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Installing a certain software is tricky</strong>, or not supported for your operating system? - Check if an image is available and run the software from a container instead!</p></li>
<li><p>You want to make sure your colleagues are using the <strong>same environment</strong> for running your code? - Provide them an image of your container!</p>
<ul>
<li><p>If this does not work, because they are using a different architecture than you do? - Provide a definition file for them to <strong>build the image suitable for their computers</strong>. This does not create the exact environment you have, but in most cases a similar enough one.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="popular-container-implementations">
<h2>Popular container implementations<a class="headerlink" href="#popular-container-implementations" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.docker.com/">Docker</a></p></li>
<li><p><a class="reference external" href="https://sylabs.io/docs/">Singularity</a> (popular on high-performance computing systems)</p></li>
<li><p><a class="reference external" href="https://apptainer.org">Apptainer</a> (popular on high-performance computing systems, fork of Singularity)</p></li>
<li><p><a class="reference external" href="https://podman.io/">podman</a></p></li>
</ul>
<p>They are to some extent interoperable:</p>
<ul class="simple">
<li><p>podman is very close to Docker</p></li>
<li><p>Docker images can be converted to Singularity/Apptainer images</p></li>
<li><p><a class="reference external" href="https://singularityhub.github.io/singularity-cli/">Singularity Python</a> can convert Dockerfiles to Singularity definition files</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="pros-and-cons-of-containers">
<h2>Pros and cons of containers<a class="headerlink" href="#pros-and-cons-of-containers" title="Link to this heading"></a></h2>
<p>Containers are popular for a reason - they solve a number of
important problems:</p>
<ul class="simple">
<li><p>Allow for seamlessly <strong>moving workflows across different platforms</strong>.</p></li>
<li><p>Can solve the <strong>“works on my machine”</strong> situation.</p></li>
<li><p>For software with many dependencies, in turn with its own dependencies,
containers offer possibly the only way to preserve the
computational experiment for <strong>future reproducibility</strong>.</p></li>
<li><p>A mechanism to “send the computer to the data” when the <strong>dataset is too large</strong> to transfer.</p></li>
<li><p><strong>Installing software into a file</strong> instead of into your computer (removing
a file is often easier than uninstalling software if you suddenly regret an
installation).</p></li>
</ul>
<p>However, containers may also have some drawbacks:</p>
<ul class="simple">
<li><p>Can be used to hide away software installation problems and thereby
<strong>discourage good software development practices</strong>.</p></li>
<li><p>Instead of “works on my machine” problem: <strong>“works only in this container”</strong> problem?</p></li>
<li><p>They can be <strong>difficult to modify</strong>.</p></li>
<li><p>Container <strong>images can become large</strong>.</p></li>
</ul>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Use only <strong>official and trusted images</strong>!  Not all images can be trusted! There
have been examples of contaminated images, so investigate before using images
blindly. Apply the same caution as when installing software packages from untrusted
package repositories.</p>
</div>
<hr class="docutils" />
<div class="admonition-optional-containers-3-explore-two-really-useful-docker-images exercise important admonition" id="exercise-0">
<p class="admonition-title">(optional) Containers-3: Explore two really useful Docker images</p>
<p>You can try the below if you have Docker installed. If you have
Singularity/Apptainer and not Docker, the goal of the exercise can be to run
the Docker containers through Singularity/Apptainer.</p>
<ol class="arabic">
<li><p>Run a specific version of <em>Rstudio</em>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8787</span>:8787<span class="w"> </span>-e<span class="w"> </span><span class="nv">PASSWORD</span><span class="o">=</span>yourpasswordhere<span class="w"> </span>rocker/rstudio
</pre></div>
</div>
<p>Then open your browser to <a class="reference external" href="http://localhost:8787">http://localhost:8787</a>
with login rstudio and password “yourpasswordhere” used in the previous
command.</p>
<p>If you want to try an older version you can check the tags at
<a class="reference external" href="https://hub.docker.com/r/rocker/rstudio/tags">https://hub.docker.com/r/rocker/rstudio/tags</a>
and run for example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8787</span>:8787<span class="w"> </span>-e<span class="w"> </span><span class="nv">PASSWORD</span><span class="o">=</span>yourpasswordhere<span class="w"> </span>rocker/rstudio:3.3
</pre></div>
</div>
</li>
<li><p>Run a specific version of <em>Anaconda3</em> from
<a class="reference external" href="https://hub.docker.com/r/continuumio/anaconda3">https://hub.docker.com/r/continuumio/anaconda3</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>run<span class="w"> </span>-i<span class="w"> </span>-t<span class="w"> </span>continuumio/anaconda3<span class="w"> </span>/bin/bash
</pre></div>
</div>
</li>
</ol>
</div>
</section>
<section id="resources-for-further-learning">
<h2>Resources for further learning<a class="headerlink" href="#resources-for-further-learning" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://carpentries-incubator.github.io/docker-introduction/">Carpentries incubator lesson on Docker</a></p></li>
<li><p><a class="reference external" href="https://carpentries-incubator.github.io/singularity-introduction/">Carpentries incubator lesson on Singularity/Apptainer</a></p></li>
</ul>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Containers can be helpful if complex setups are needed to run a specific software.</p></li>
<li><p>They can also be helpful for prototyping without “messing up” your own computing environment, or for running software that requires a different operating system than your own.</p></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../dependencies/" class="btn btn-neutral float-left" title="Recording dependencies" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../where-to-go/" class="btn btn-neutral float-right" title="Where to go from here" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright CodeRefinery contributors &amp; AaltoRSE.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>